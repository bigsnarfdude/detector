2026-01-13 04:18:08,423 | INFO | Logging to: results/experiment.log
2026-01-13 04:18:08,423 | INFO | ======================================================================
2026-01-13 04:18:08,423 | INFO | GEMMA-3-27B SAE INTENT DETECTION EXPERIMENT
2026-01-13 04:18:08,423 | INFO | ======================================================================
2026-01-13 04:18:08,423 | INFO | Timestamp: 20260113_041808
2026-01-13 04:18:08,423 | INFO | Layers: [31, 40, 53]
2026-01-13 04:18:08,423 | INFO | N train samples per class: 500
2026-01-13 04:18:08,638 | INFO | Device: cuda
2026-01-13 04:18:11,045 | INFO | Loading Gemma-3-27B-IT model...
2026-01-13 04:18:13,837 | INFO | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2026-01-13 04:18:23,551 | INFO | Model loaded. Device: cuda:0
2026-01-13 04:18:23,709 | INFO | Loaded transcoder for layer 31: w_enc=torch.Size([5376, 16384])
2026-01-13 04:18:23,880 | INFO | Loaded transcoder for layer 40: w_enc=torch.Size([5376, 16384])
2026-01-13 04:18:24,119 | INFO | Loaded transcoder for layer 53: w_enc=torch.Size([5376, 16384])
2026-01-13 04:18:24,130 | INFO | 
--- Loading Training Data (Opus-curated) ---
2026-01-13 04:18:24,268 | INFO | Loaded 500 alignment_faking samples
2026-01-13 04:18:24,278 | INFO | Loaded 250 aligned samples
2026-01-13 04:18:24,311 | INFO | Loaded 250 hard_negative samples
2026-01-13 04:18:24,313 | INFO | 
--- Loading Test Data (gold_106 - EVAL ONLY) ---
2026-01-13 04:18:24,411 | INFO | Loaded gold_106: 106 samples (EVAL ONLY)
2026-01-13 04:18:24,411 | INFO |   Label distribution: 0 AF, 106 non-AF
2026-01-13 04:18:24,411 | INFO | 
--- Extracting Training Features ---
2026-01-13 04:19:23,192 | INFO | Logging to: results/experiment.log
2026-01-13 04:19:23,192 | INFO | ======================================================================
2026-01-13 04:19:23,192 | INFO | GEMMA-3-27B SAE INTENT DETECTION EXPERIMENT
2026-01-13 04:19:23,192 | INFO | ======================================================================
2026-01-13 04:19:23,192 | INFO | Timestamp: 20260113_041923
2026-01-13 04:19:23,192 | INFO | Layers: [31, 40, 53]
2026-01-13 04:19:23,192 | INFO | N train samples per class: 500
2026-01-13 04:19:23,407 | INFO | Device: cuda
2026-01-13 04:19:25,601 | INFO | Loading Gemma-3-27B-IT model...
2026-01-13 04:19:27,414 | INFO | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
2026-01-13 04:19:35,983 | INFO | Model loaded. Device: cuda:0
2026-01-13 04:19:36,136 | INFO | Loaded transcoder for layer 31: w_enc=torch.Size([5376, 16384])
2026-01-13 04:19:36,296 | INFO | Loaded transcoder for layer 40: w_enc=torch.Size([5376, 16384])
2026-01-13 04:19:36,462 | INFO | Loaded transcoder for layer 53: w_enc=torch.Size([5376, 16384])
2026-01-13 04:19:36,469 | INFO | 
--- Loading Training Data (Opus-curated) ---
2026-01-13 04:19:36,558 | INFO | Loaded 500 alignment_faking samples
2026-01-13 04:19:36,570 | INFO | Loaded 250 aligned samples
2026-01-13 04:19:36,604 | INFO | Loaded 250 hard_negative samples
2026-01-13 04:19:36,606 | INFO | 
--- Loading Test Data (gold_106 - EVAL ONLY) ---
2026-01-13 04:19:36,690 | INFO | Loaded gold_106: 106 samples (EVAL ONLY)
2026-01-13 04:19:36,691 | INFO |   Label distribution: 51 AF, 55 non-AF
2026-01-13 04:19:36,691 | INFO | 
--- Extracting Training Features ---
2026-01-13 04:21:06,885 | INFO | Train feature shape: (1000, 196608)
2026-01-13 04:21:06,885 | INFO | 
--- Extracting Test Features (gold_106) ---
2026-01-13 04:21:18,678 | INFO | Test feature shape: (106, 196608)
2026-01-13 04:21:18,679 | INFO | 
--- Training & Evaluation ---
2026-01-13 04:21:21,240 | INFO | Training linear probe...
2026-01-13 04:21:36,934 | INFO | Training CV AUROC: 0.9572 (+/- 0.0095)
2026-01-13 04:21:39,855 | INFO | Test AUROC (gold_106): 0.5854
2026-01-13 04:21:39,856 | INFO | 
Classification Report (gold_106):
2026-01-13 04:21:39,860 | INFO |               precision    recall  f1-score   support

      non-AF       0.57      0.65      0.61        55
          AF       0.56      0.47      0.51        51

    accuracy                           0.57       106
   macro avg       0.56      0.56      0.56       106
weighted avg       0.57      0.57      0.56       106

2026-01-13 04:21:39,863 | INFO | 
Results saved: results/experiment_20260113_041923.json
2026-01-13 04:21:39,864 | INFO | Predictions saved: results/gold_106_predictions.json
2026-01-13 04:21:39,864 | INFO | 
======================================================================
2026-01-13 04:21:39,864 | INFO | SUMMARY
2026-01-13 04:21:39,864 | INFO | ======================================================================
2026-01-13 04:21:39,864 | INFO | Train CV AUROC: 0.9572
2026-01-13 04:21:39,864 | INFO | gold_106 AUROC: 0.5854
2026-01-13 04:21:39,864 | INFO | Train/Test Gap: 0.3718
