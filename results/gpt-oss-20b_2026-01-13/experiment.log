`torch_dtype` is deprecated! Use `dtype` instead!
MXFP4 quantization requires Triton and kernels installed: CUDA requires Triton >= 3.4.0, XPU requires Triton >= 3.5.0, we will default to dequantizing the model to bf16
======================================================================
GPT-OSS 20B CROSS-VALIDATION EXPERIMENT
======================================================================
Model: unsloth/gpt-oss-20b
SAE: Goodfire/Hackathon-gpt-oss-20b-SAE-l15 (layer 15)
Serial processing: Model → Save → Unload → SAE → Unload → Probe

[DATA] Loading training data...
  Training: 500 AF, 500 aligned
[DATA] Loading gold_106 test set...
  Test: 51 AF, 55 aligned

======================================================================
PHASE 1: EXTRACT ACTIVATIONS
======================================================================
Model: unsloth/gpt-oss-20b
Layer: 15
Samples: 1106

[1/3] Loading GPT-OSS 20B (4-bit)...
Fetching 3 files:   0%|          | 0/3 [00:00<?, ?it/s]Fetching 3 files:  33%|███▎      | 1/3 [00:12<00:25, 12.62s/it]Fetching 3 files:  67%|██████▋   | 2/3 [00:13<00:05,  5.63s/it]Fetching 3 files: 100%|██████████| 3/3 [00:13<00:00,  4.45s/it]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.06s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.02s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.13it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.08it/s]
  Model loaded on cuda:0

[2/3] Extracting layer {layer} activations...
    4/1106 samples...
    104/1106 samples...
    204/1106 samples...
    304/1106 samples...
    404/1106 samples...
    504/1106 samples...
    604/1106 samples...
    704/1106 samples...
    804/1106 samples...
    904/1106 samples...
    1004/1106 samples...
    1104/1106 samples...
  Activations shape: torch.Size([1106, 2880])

[3/3] Saving activations and unloading model...
  Saved to gpt_oss_results/activations_l15.pt
  Model unloaded, GPU memory freed

======================================================================
PHASE 2: PROCESS WITH SAE
======================================================================

[SAE] Loading Goodfire SAE...
Traceback (most recent call last):
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 402, in hf_raise_for_status
    response.raise_for_status()
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://huggingface.co/Goodfire/Hackathon-gpt-oss-20b-SAE-l15/resolve/main/sae_weights.safetensors

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/ubuntu/detector/scripts/gpt_oss_experiment.py", line 487, in <module>
    main()
  File "/home/ubuntu/detector/scripts/gpt_oss_experiment.py", line 444, in main
    features = process_with_sae(activations)
  File "/home/ubuntu/detector/scripts/gpt_oss_experiment.py", line 322, in process_with_sae
    weights, config = load_goodfire_sae()
  File "/home/ubuntu/detector/scripts/gpt_oss_experiment.py", line 243, in load_goodfire_sae
    weights_path = hf_hub_download(
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1007, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1070, in _hf_hub_download_to_cache_dir
    (url_to_download, etag, commit_hash, expected_size, xet_file_data, head_call_error) = _get_metadata_or_catch_error(
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1543, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/utils/_validators.py", line 114, in _inner_fn
    return fn(*args, **kwargs)
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 1460, in get_hf_file_metadata
    r = _request_wrapper(
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 283, in _request_wrapper
    response = _request_wrapper(
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/file_download.py", line 307, in _request_wrapper
    hf_raise_for_status(response)
  File "/home/ubuntu/detector/venv/lib/python3.10/site-packages/huggingface_hub/utils/_http.py", line 413, in hf_raise_for_status
    raise _format(EntryNotFoundError, message, response) from e
huggingface_hub.errors.EntryNotFoundError: 404 Client Error. (Request ID: Root=1-69665abb-08ea80380c249e5c188176e5;7b933b0d-4566-4f44-9410-eae6aa3d9246)

Entry Not Found for url: https://huggingface.co/Goodfire/Hackathon-gpt-oss-20b-SAE-l15/resolve/main/sae_weights.safetensors.
